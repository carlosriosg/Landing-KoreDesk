<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KoreDesk - Centraliza. Automatiza. Vende.</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet">
  </head>
  
  <body class="bg-white text-slate-900 font-sans overflow-x-hidden">
    <div id="root"></div>
    
    <script type="module" src="/index.tsx"></script>

    <script>
      (function(d,t) {
        var BASE_URL="https://app.koredesk.com";
        var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=BASE_URL+"/packs/js/sdk.js";
        g.async = true;
        s.parentNode.insertBefore(g,s);
        g.onload=function(){
          window.chatwootSDK.run({
            websiteToken: 'CZPdqmyAvy3pku3XjXxW6eKe',
            baseUrl: BASE_URL
          })
        }
      })(document,"script");
    </script>

    <script>
      // DelegaciÃ³n de eventos: Escucha clics en todo el documento
      // (Ideal para React porque funciona aunque los botones carguen despuÃ©s)
      document.addEventListener('click', function(e) {
        
        // 1. Detectar si el elemento clicado (o su padre) es el botÃ³n "Agendar Demo"
        const target = e.target.closest('button') || e.target;
        
        // Verificamos si tiene el texto correcto
        if (target && target.innerText && target.innerText.includes('Agendar Demo')) {
            
            // 2. Buscar el campo de email mÃ¡s cercano
            const inputEmail = document.querySelector('input[type="email"]');
            
            // Si no hay input de email, no es el formulario correcto, salimos.
            if (!inputEmail) return; 

            // Prevenimos comportamiento por defecto
            e.preventDefault(); 

            const email = inputEmail.value;

            // ðŸ‘‡ðŸ‘‡ðŸ‘‡ðŸ‘‡ PEGA AQUÃ TU URL DE N8N (WEBHOOK PRODUCTION) ðŸ‘‡ðŸ‘‡ðŸ‘‡ðŸ‘‡
            const n8nUrl = 'https://n8n.koredesk.com/webhook/nuevo-lead'; 
            // ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†ðŸ‘†

            // ValidaciÃ³n simple
            if (!email || !email.includes('@')) {
                alert("âš ï¸ Por favor ingresa un correo vÃ¡lido.");
                return;
            }

            // Feedback Visual: "Enviando..."
            const textoOriginal = target.innerText;
            target.innerText = "Enviando... ðŸš€";
            target.style.opacity = "0.7";
            target.disabled = true;

            // Enviar datos a n8n
            fetch(n8nUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email: email })
            })
            .then(res => {
                if (res.ok) {
                    alert("âœ… Â¡Recibido! Te contactaremos pronto.");
                    inputEmail.value = ""; // Limpiar campo
                    target.innerText = "Â¡Enviado!";
                } else {
                    target.innerText = "Error âŒ";
                    alert("Hubo un error al enviar. Intenta nuevamente.");
                }
            })
            .catch(err => {
                console.error('Error enviando a n8n:', err);
                target.innerText = textoOriginal;
            })
            .finally(() => {
                // Restaurar botÃ³n a los 3 segundos
                setTimeout(() => {
                    target.disabled = false;
                    target.innerText = textoOriginal;
                    target.style.opacity = "1";
                }, 3000);
            });
        }
      });
    </script>
    
  </body>
</html>
